<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lemur EchoMe P2P Receiver</title>
  <link rel="stylesheet" href="mobile-style.css" />
  <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
  
  <style>
    /* ğŸ¯ BOTÃƒO AZUL SOBRE O MICROFONE */
    #tecladoTrigger {
      position: absolute;
      background-color: rgba(0, 150, 255, 0.3);
      border: 2px dashed #0096FF;
      cursor: pointer;
      z-index: 10000;
      border-radius: 50%;
    }
    
    /* INPUT OCULTO */
    #inputOculto {
      position: absolute;
      left: -9999px;
      opacity: 0;
      width: 1px;
      height: 1px;
    }
  </style>
</head>

<body>

  <div class="box-principal">

    <img src="assets/images/lemurBlu.png" alt="Lemur Logo" class="logo" />
    <img src="assets/images/Bridg.png" alt="ponte" class="ponte" />
    <img id="click" src="assets/images/click.png" alt="Click" />
    
    <div id="mobileLoading" class="mobile-loader">
      <div class="loader-circle"></div>
    </div>

    <div id="instructionBox"></div>

    <button id="logo-traduz" class="botao-key">
      <img src="assets/images/key.png" alt="Gerar QR Code" />
    </button>

    <button id="toggleCamera" class="camera-toggle-btn">
      <img src="assets/images/girar-camera.png" alt="Alternar CÃ¢mera" />
    </button>

    <div class="translator-label" id="translator-label">
      Real-time translation.
    </div>

    <div class="social-links-fixed"></div>

    <div class="remoter-Lang">ğŸ³ï¸</div>
    <div class="local-Lang">ğŸ³ï¸</div>
    <div class="local-mic-Lang">ğŸ³ï¸</div>

    <div class="video-wrapper">
      <video id="remoteVideo" autoplay playsinline></video>
      <div class="pip-local-wrapper">
        <video id="localVideo" autoplay muted playsinline></video>
      </div>
    </div>
   
    <div class="info-overlay hidden">
      <h2 id="qr-modal-title">This is your online key</h2>
      <div class="qrcode-container">
        <div id="qrcode"></div>
      </div>
      <p class="qr-modal-description" id="qr-modal-description">
        You can ask to scan, share or print on your business card.
      </p>
      <div class="social-buttons"></div>
      <button id="copiarLink" class="btn-copiar-simples">ğŸ”—</button>
    </div>

    <div id="texto-recebido"></div>
    <div class="language-flag" id="currentLanguageFlag">ğŸ‡§ğŸ‡·</div>

    <!-- ğŸ¤ MICROFONE ORIGINAL -->
    <button class="record-btn" id="recordButton">ğŸ¤</button>

    <!-- ğŸ”µ BOTÃƒO AZUL SOBRE O MICROFONE -->
    <button id="tecladoTrigger" title="Abrir teclado nativo"></button>
    
    <!-- ğŸ“ INPUT OCULTO -->
    <input type="text" id="inputOculto" placeholder="Fale ou digite...">

  </div>

  <div class="recording-modal hidden-until-ready" id="recordingModal">
    <div class="recording-indicator">
      <div class="recording-dot"></div>
      <div class="recording-text">â—</div>
      <div class="recording-timer" id="recordingTimer">0:00</div>
    </div>
    <button class="send-button" id="sendButton">ğŸ“¤</button>
  </div>

  <script>
    // ğŸ¯ CONFIGURAÃ‡ÃƒO SIMPLES DO BOTÃƒO AZUL
    document.addEventListener('DOMContentLoaded', function () {
      
      // Posicionar botÃ£o azul sobre o microfone
      function posicionarBotao() {
        const microfone = document.getElementById('recordButton');
        const botaoAzul = document.getElementById('tecladoTrigger');
        if (microfone && botaoAzul) {
          const pos = microfone.getBoundingClientRect();
          botaoAzul.style.position = 'fixed';
          botaoAzul.style.left = pos.left + 'px';
          botaoAzul.style.top = pos.top + 'px';
          botaoAzul.style.width = pos.width + 'px';
          botaoAzul.style.height = pos.height + 'px';
        }
      }
      
      posicionarBotao();
      window.addEventListener('resize', posicionarBotao);
      
      // Quando clicar no botÃ£o azul
      const botaoAzul = document.getElementById('tecladoTrigger');
      const inputOculto = document.getElementById('inputOculto');
      
      if (botaoAzul && inputOculto) {
        botaoAzul.addEventListener('click', function() {
          inputOculto.focus(); // Abre teclado
        });
        
        // Quando teclado gerar texto (do microfone ou digitaÃ§Ã£o)
        inputOculto.addEventListener('input', function(event) {
          const texto = event.target.value.trim();
          if (texto !== '') {
            // ğŸš€ Enviar para traduÃ§Ã£o
            startTranslation(texto);
            // Limpar input
            setTimeout(() => {
              inputOculto.value = '';
            }, 100);
          }
        });
      }
    });

    // FunÃ§Ãµes existentes do seu projeto
    window.liberarInterface = function () {
      console.log('âœ… Interface liberada');
    };

    window.mostrarErroCarregamento = function (mensagem) {
      alert('Erro: ' + mensagem);
    };
  </script>

  <!-- Seus scripts existentes -->
  <script src="core/redes-sociais.js"></script>
  <script src="core/instruction-box.js"></script>
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <script type="module" src="./js/receiver/receiver-ui.js"></script>
  <script src="./js/receiver/receiver-trz.js"></script>
  
</body>
</html>
